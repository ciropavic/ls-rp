<div class="group" id="personal">
    <h2 class="header">Personal Data</h2>
    <div class="datainput">
        <h3 class="header">First name</h3>
        <div class="controls">
            <input id="firstname" class="name" type="text" name="firstname" spellcheck="false" placeholder="" onKeyDown="if(this.value.length==15 && event.keyCode!=8) return false;" onkeypress="if (isNumber(event) == true) return false;" onKeyUp="checkName('firstname')" onmouseup="checkName('firstname')">
        </div>
    </div>
    <div class="datainput">
        <h3 class="header">Last name</h3>
        <div class="controls">
            <input id="lastname" class="name" type="text" name="lastname" spellcheck="false" placeholder="" onKeyDown="if(this.value.length==15 && event.keyCode!=8) return false;" onkeypress="if (isNumber(event) == true) return false;" onKeyUp="checkName('lastname')" onmouseup="checkName('lastname')">
        </div>
    </div>
    <div class="datainput">
        <h3 class="header">Date of birth</h3>
        <div class="controls">
            <input id="dateofbirth" type="date" name="dateofbirth" placeholder="mm/dd/yyyy" dateformat="M d y" min="1957-01-01" max="2007-12-31" onkeypress="if ( isNaN(String.fromCharCode(event.keyCode) )) return false;" onchange="checkDOB()" onKeyUp="checkDOB()" onmouseup="checkDOB()">
        <p id ="dateerror"></p>
        </div>
    </div>
    <div class="slider">
        <h3 class="header">Height</h3>
        <div class="valuelabel center">0</div>
        <div class="controls">
            <button class="arrow left"></button>
            <input id="height" type="range" min="0" max="100">
            <button class="arrow right"></button>
        </div>
    </div>
    <!-- <div class="name">Nationality</div>
    <div class="value">
        <div class="row row-refine">
            <div class="col-9">
                <div class="input-group-desc">
                    <select name="selectBox" id="selectBox" class='selectBox'>
                        <option value="mexico" selected>M</option>
                        <option value="america">A</option>
                        <option value="korea">K</option>
                    </select>
                    </body>
                </div>
            </div>
        </div>
    </div> -->
    <div class="list">
        <h3 class="header">Nationality</h3>
        <div class="controls">
            <button class="arrow left"></button>
            <select class="selectBox" id="selectBox">
                <option value="American">AMERICAN</option>
                <option value="Hispanic">HISPANIC</option>
                <option value="Asian">ASIAN</option>
                <option value="Europian">EUROPIAN</option>
            </select>
            <button class="arrow right"></button>
        </div>
    </div>

    <style>
        #firstname
        {
            font-size: 15px;
        }
        #lastname
        {
            font-size: 15px;
        }
    </style>



<script>
     $("#firstname").bind("keyup",function()
    {
        var str = $(this).val();
        var firstLetter = str.substring(0,1);
        var remainLetter = str.substring(1);
        firstLetter = firstLetter.toUpperCase();
        remainLetter = remainLetter.toLowerCase();
        var result = firstLetter + remainLetter;
        $(this).val(result);
    })
    $("#lastname").bind("keyup",function()
    {
        var str = $(this).val();
        var firstLetter = str.substring(0,1);
        var remainLetter = str.substring(1);
        firstLetter = firstLetter.toUpperCase();
        remainLetter = remainLetter.toLowerCase();
        var result = firstLetter + remainLetter;
        $(this).val(result);
    })
</script>

    <script>
        // check as soon as the elements are there
        checkName('firstname');
        checkName('lastname');
        checkDOB();


        // Code adapted and modified from esx_identity
        function isNumber(e) {
            let key=e.which || e.KeyCode;
            if ( key >=48 && key <= 57) {
                return true; 
            }
            else {
                return false;
            }
        }


        function checkName(name) {
            let target = document.getElementById(name);
            let value = target.value;
            let trimmed = value.trim();
            if((trimmed.match(/^[a-zA-Z][0-9a-zA-Z .,'-]*$/) == null) ||
              (trimmed != (trimmed.charAt(0).toUpperCase() + trimmed.slice(1).toLowerCase())) ||
              (/\s/g.test(value))) {
                target.parentElement.style.border = '0.15vh solid #E06666';
            }
            else {
                if(value.length > 0 && value.length < 17) {
                    target.parentElement.style.border = 'none';
                }
                else {
                    target.parentElement.style.border = '0.15vh solid #E06666';
                }
            }
        }

        function checkDOB() {
            let myDOB = document.getElementById('dateofbirth');
            let date = new Date($('#dateofbirth').val());
            day = date.getDate();
            month = date.getMonth() + 1;
            year = date.getFullYear();
            if (isNaN(month) || isNaN(day) || isNaN(year)) {
                myDOB.parentElement.style.border = '0.15vh solid #E06666';
            }
            else {
                let dateInput = [month, day, year].join('/');

                let regExp = /^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/;
                let dateArray = dateInput.match(regExp);

                if (dateArray == null){
                    return false;
                }

                month = dateArray[1];
                day= dateArray[3];
                year = dateArray[5];
                console.log(month);
                console.log(day);
                console.log(year);

                if (month < 1 || month > 12){
                    myDOB.parentElement.style.border = '0.15vh solid #E06666';
                    
                }
                else if (day < 1 || day> 31) { 
                    myDOB.parentElement.style.border = '0.15vh solid #E06666';
                }
                else if ((month==4 || month==6 || month==9 || month==11) && day == 31) {
                    myDOB.parentElement.style.border = '0.15vh solid #E06666';
                }
                else if (month == 2) {
                    let isLeapYear = (year % 4 == 0 && (year % 100 != 0 || year % 400 == 0));
                    if (day> 29 || (day == 29 && !isLeapYear)){
                        myDOB.parentElement.style.border = '0.15vh solid #E06666';
                    }
                }
                else if ((year < identityLimits.yearmin) || (year > identityLimits.yearmax)) {
                    myDOB.parentElement.style.border = '0.15vh solid #E06666';
                }
                else {
                    myDOB.parentElement.style.border = 'none';
                }
            }
        }
    </script>
</div>